version: 2
jobs:
  build:
    docker:
      - image: ubuntu:16.04
    environment:
      - LANG: "en_GB.UTF-8"
      - PIPENV_IGNORE_VIRTUALENVS: "1"
    steps:
      - run:
          name: Setup Pipenv
          command: pip install pipenv
      - run:
          name: Install deps
          command: pipenv install --dev
      - run:
          name: Compile translations
          command: bash bin/compile-translations
      - run:
          name: Tests
          command: pipenv run pytest -v --cov=squeezealexa --cov-report=term
      - run:
          name: Code Quality
          command: pipenv run flake8 --statistics .
      - run:
          name: Coverage submission
          command: pip run coveralls
